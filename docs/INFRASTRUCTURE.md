# Catxi Backend - ì¸í”„ë¼ ë¬¸ì„œ

## ğŸ“Š ì¸í”„ë¼ êµ¬ì„±ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AWS ap-northeast-2 (Seoul)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  VPC (10.0.0.0/16)                           â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚ Public Subnet (AZ-a) â”‚  â”‚ Public Subnet (AZ-c) â”‚        â”‚   â”‚
â”‚  â”‚  â”‚   10.0.1.0/24        â”‚  â”‚   10.0.2.0/24        â”‚        â”‚   â”‚
â”‚  â”‚  â”‚                      â”‚  â”‚                      â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚                      â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ EC2 Instance  â”‚   â”‚  â”‚                      â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ t2.micro      â”‚â—„â”€â”€â”¼â”€â”€â”¼â”€ Elastic IP         â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚               â”‚   â”‚  â”‚   (Static Public)    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Docker:       â”‚   â”‚  â”‚                      â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ - Spring Boot â”‚   â”‚  â”‚                      â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ - Redis       â”‚   â”‚  â”‚                      â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚                      â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚Private Subnet (AZ-a) â”‚  â”‚Private Subnet (AZ-c) â”‚        â”‚   â”‚
â”‚  â”‚  â”‚   10.0.11.0/24       â”‚  â”‚   10.0.12.0/24       â”‚        â”‚   â”‚
â”‚  â”‚  â”‚                      â”‚  â”‚                      â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ RDS Primary   â”‚   â”‚  â”‚  â”‚ RDS Standby   â”‚   â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ MySQL 8.0     â”‚â—„â”€â”€â”¼â”€â”€â”¼â”€â–ºâ”‚ (Multi-AZ)    â”‚   â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ db.t3.micro   â”‚   â”‚  â”‚  â”‚               â”‚   â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ Internet Gateway                                       â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ECR Repository: catxi-backend                                 â”‚ â”‚
â”‚  â”‚ - Image Scanning: Enabled                                     â”‚ â”‚
â”‚  â”‚ - Encryption: AES256                                          â”‚ â”‚
â”‚  â”‚ - Lifecycle: Keep 10 images                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ S3 Bucket: catxi-terraform-state                              â”‚ â”‚
â”‚  â”‚ - Versioning: Enabled                                         â”‚ â”‚
â”‚  â”‚ - Encryption: AES256                                          â”‚ â”‚
â”‚  â”‚ - Public Access: Blocked                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ DynamoDB: catxi-terraform-locks                               â”‚ â”‚
â”‚  â”‚ - Billing: On-Demand                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ì£¼ìš” ë¦¬ì†ŒìŠ¤

### VPC ë° ë„¤íŠ¸ì›Œí¬

| ë¦¬ì†ŒìŠ¤ | CIDR / ê°’ | ìš©ë„ |
|--------|-----------|------|
| VPC | 10.0.0.0/16 | ê²©ë¦¬ëœ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ |
| Public Subnet 1 | 10.0.1.0/24 (AZ-a) | EC2 ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ |
| Public Subnet 2 | 10.0.2.0/24 (AZ-c) | ê³ ê°€ìš©ì„± ì˜ˆë¹„ |
| Private Subnet 1 | 10.0.11.0/24 (AZ-a) | RDS Primary |
| Private Subnet 2 | 10.0.12.0/24 (AZ-c) | RDS Standby (Multi-AZ) |
| Internet Gateway | - | Public subnet ì¸í„°ë„· ì—°ê²° |

### EC2 Instance

| í•­ëª© | ê°’ | ì„¤ëª… |
|------|-----|------|
| **AMI** | Ubuntu 24.04 LTS | ìµœì‹  Long Term Support |
| **Instance Type** | t2.micro | 1 vCPU, 1GB RAM (Free Tier) |
| **Storage** | 20GB gp3 | ì•”í˜¸í™” í™œì„±í™” |
| **Public IP** | Elastic IP | ê³ ì • IP ì£¼ì†Œ |
| **IAM Role** | catxi-ec2-role | ECR ì ‘ê·¼ ê¶Œí•œ |
| **Key Pair** | popol-key | SSH ì ‘ì†ìš© |

**ì„¤ì¹˜ëœ ì†Œí”„íŠ¸ì›¨ì–´ (user-data.sh):**
- Docker 26.x
- Docker Compose 2.24.5
- AWS CLI v2
- Git, Vim, Htop, JQ

**ì‹œìŠ¤í…œ ì„¤ì •:**
- Timezone: Asia/Seoul
- Swap: 2GB
- Systemd Service: catxi-backend.service

### RDS MySQL

| í•­ëª© | ê°’ | ì„¤ëª… |
|------|-----|------|
| **Engine** | MySQL 8.0.35 | ìµœì‹  ì•ˆì • ë²„ì „ |
| **Instance Class** | db.t3.micro | 2 vCPU, 1GB RAM |
| **Storage** | 20GB gp3 | Auto-scaling up to 40GB |
| **Multi-AZ** | false (ê¸°ë³¸ê°’) | true ì„¤ì • ì‹œ ê³ ê°€ìš©ì„± |
| **Backup** | 7ì¼ ë³´ê´€ | ìë™ ë°±ì—… 03:00-04:00 UTC |
| **Encryption** | Enabled | ì €ì¥ ë°ì´í„° ì•”í˜¸í™” |
| **Monitoring** | Enhanced (60s) | CloudWatch ìƒì„¸ ëª¨ë‹ˆí„°ë§ |

**Parameter Group ì„¤ì •:**
```hcl
character_set_server = utf8mb4
collation_server = utf8mb4_unicode_ci
time_zone = Asia/Seoul
max_connections = 100
slow_query_log = 1
long_query_time = 2
```

### Security Groups

**sg-app (Application Server)**

| Direction | Protocol | Port | Source | ìš©ë„ |
|-----------|----------|------|--------|------|
| Inbound | TCP | 22 | Jenkins IP | SSH ì ‘ì† |
| Inbound | TCP | 80 | 0.0.0.0/0 | HTTP (ë¯¸ë˜ NGINX) |
| Inbound | TCP | 443 | 0.0.0.0/0 | HTTPS (ë¯¸ë˜ SSL) |
| Inbound | TCP | 8080 | 0.0.0.0/0 | Spring Boot |
| Outbound | All | All | 0.0.0.0/0 | ëª¨ë“  ì•„ì›ƒë°”ìš´ë“œ |

**sg-rds (RDS MySQL)**

| Direction | Protocol | Port | Source | ìš©ë„ |
|-----------|----------|------|--------|------|
| Inbound | TCP | 3306 | sg-app | MySQL ì—°ê²° |
| Outbound | - | - | - | ì°¨ë‹¨ë¨ |

### IAM Role

**catxi-ec2-role (EC2 Instance Profile)**

ê¶Œí•œ:
- `ecr:GetAuthorizationToken` - ECR ë¡œê·¸ì¸
- `ecr:BatchCheckLayerAvailability` - ì´ë¯¸ì§€ ë ˆì´ì–´ í™•ì¸
- `ecr:GetDownloadUrlForLayer` - ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
- `ecr:BatchGetImage` - ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°
- `logs:CreateLogGroup/Stream` - CloudWatch ë¡œê·¸
- `logs:PutLogEvents` - ë¡œê·¸ ì „ì†¡

### ECR Repository

| í•­ëª© | ê°’ | ì„¤ëª… |
|------|-----|------|
| **ì´ë¦„** | catxi-backend | Docker ì´ë¯¸ì§€ ì €ì¥ì†Œ |
| **Tag Mutability** | MUTABLE | íƒœê·¸ ë®ì–´ì“°ê¸° ê°€ëŠ¥ |
| **Scan on Push** | Enabled | ì·¨ì•½ì  ìë™ ìŠ¤ìº” |
| **Encryption** | AES256 | ì´ë¯¸ì§€ ì•”í˜¸í™” |
| **Lifecycle Policy** | Keep 10 | ìµœì‹  10ê°œ ì´ë¯¸ì§€ë§Œ ë³´ê´€ |

---

## ğŸ’° ë¹„ìš© ë¶„ì„

### ì›”ê°„ ì˜ˆìƒ ë¹„ìš© (ap-northeast-2)

| ë¦¬ì†ŒìŠ¤ | ì‚¬ì–‘ | ì›” ë¹„ìš© | ë¹„ê³  |
|--------|------|---------|------|
| **EC2 t2.micro** | 1 vCPU, 1GB RAM | $8.50 | Free Tier 1ë…„ (ì‹ ê·œ ê³„ì •) |
| **RDS db.t3.micro** | 2 vCPU, 1GB RAM | $15.00 | Single-AZ |
| **RDS Storage** | 20GB gp3 | $2.50 | |
| **Elastic IP** | 1ê°œ (ì—°ê²°ë¨) | $0.00 | ë¯¸ì—°ê²° ì‹œ $3.65 |
| **ECR** | ~5GB | $0.50 | $0.10/GB |
| **S3** | <1GB | $0.02 | Terraform state |
| **DynamoDB** | On-Demand | $0.01 | State locking |
| **Data Transfer** | ~10GB out | $0.90 | $0.09/GB |
| **CloudWatch** | Logs, Alarms | $1.00 | ê¸°ë³¸ ëª¨ë‹ˆí„°ë§ |
| **ì´ ì˜ˆìƒ ë¹„ìš©** | | **~$28.43** | |

### ë¹„ìš© ì ˆê° ë°©ë²•

1. **Reserved Instance (EC2)**
   - 1ë…„ ì•½ì •: 30% ì ˆê° â†’ $5.95/ì›”
   - 3ë…„ ì•½ì •: 50% ì ˆê° â†’ $4.25/ì›”

2. **RDS Reserved Instance**
   - 1ë…„ ì•½ì •: 30% ì ˆê° â†’ $10.50/ì›”

3. **ê°œë°œ í™˜ê²½ ë¶„ë¦¬**
   - Dev: t2.micro + db.t3.micro Single-AZ
   - Prod: t3.small + db.t3.small Multi-AZ
   - Dev ì•¼ê°„/ì£¼ë§ ìë™ ì •ì§€

4. **ECR ì´ë¯¸ì§€ ì •ë¦¬**
   - Lifecycle policyë¡œ ìë™ ì‚­ì œ (í˜„ì¬ 10ê°œ ë³´ê´€)
   - ê°œë°œ ì´ë¯¸ì§€ëŠ” ë³„ë„ ë¦¬í¬ì§€í† ë¦¬

---

## ğŸ” ë³´ì•ˆ ì„¤ì •

### ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ

1. **VPC ê²©ë¦¬**
   - Private Subnet: RDS (ì¸í„°ë„· ì ‘ê·¼ ë¶ˆê°€)
   - Public Subnet: EC2 (Elastic IPë§Œ)

2. **Security Group ìµœì†Œ ê¶Œí•œ**
   - SSH: Jenkins IPë§Œ í—ˆìš©
   - RDS: EC2 Security Groupë§Œ í—ˆìš©

3. **NACL (Network ACL)**
   - ê¸°ë³¸ ì„¤ì • ì‚¬ìš© (ëª¨ë“  íŠ¸ë˜í”½ í—ˆìš©)
   - í•„ìš” ì‹œ ì¶”ê°€ ì œí•œ ê°€ëŠ¥

### ë°ì´í„° ë³´ì•ˆ

1. **ì•”í˜¸í™”**
   - RDS: ì €ì¥ ë°ì´í„° ì•”í˜¸í™” (AES-256)
   - EBS: ë£¨íŠ¸ ë³¼ë¥¨ ì•”í˜¸í™”
   - S3: Terraform state ì•”í˜¸í™”
   - ECR: ì´ë¯¸ì§€ ì•”í˜¸í™”

2. **ë°±ì—…**
   - RDS: ìë™ ë°±ì—… 7ì¼ ë³´ê´€
   - ìˆ˜ë™ ìŠ¤ëƒ…ìƒ· ìƒì„± ê°€ëŠ¥

3. **Secrets ê´€ë¦¬**
   - Jenkins Credentials: ì•”í˜¸í™” ì €ì¥
   - .env íŒŒì¼: EC2ì—ì„œ 600 ê¶Œí•œ
   - terraform.tfvars: Gitì—ì„œ ì œì™¸

### IAM ë³´ì•ˆ

1. **ìµœì†Œ ê¶Œí•œ ì›ì¹™**
   - EC2 Role: ECR ì ‘ê·¼ë§Œ
   - Terraform User: ì¸í”„ë¼ ê´€ë¦¬ë§Œ

2. **Access Key ê´€ë¦¬**
   - 90ì¼ë§ˆë‹¤ êµì²´ ê¶Œì¥
   - MFA í™œì„±í™” ê¶Œì¥

---

## ğŸ“ˆ ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒ

### CloudWatch Metrics

**EC2 Metrics (5ë¶„ ê°„ê²©):**
- CPUUtilization
- NetworkIn/Out
- DiskReadOps/WriteOps
- StatusCheckFailed

**RDS Metrics (1ë¶„ ê°„ê²©):**
- CPUUtilization
- DatabaseConnections
- FreeableMemory
- ReadLatency / WriteLatency
- FreeStorageSpace

### CloudWatch Alarms

**ìë™ ìƒì„±ë˜ëŠ” ì•ŒëŒ:**

| ì•ŒëŒ | ì¡°ê±´ | ì„¤ëª… |
|------|------|------|
| high-cpu | CPU > 80% (2íšŒ) | EC2 CPU ê³¼ë¶€í•˜ |
| status-check-failed | Status Check Failed | EC2 í—¬ìŠ¤ ì²´í¬ ì‹¤íŒ¨ |

**ì¶”ê°€ ê¶Œì¥ ì•ŒëŒ:**
- RDS CPU > 80%
- RDS Storage < 10%
- RDS Connections > 80
- EC2 Disk > 80%

### Logs

**Application Logs:**
- ìœ„ì¹˜: `/home/ubuntu/catxi/logs/`
- Rotation: 50MB, 5ì¼ ë³´ê´€
- ìˆ˜ì§‘: CloudWatch Logs (ì„ íƒì‚¬í•­)

**RDS Logs:**
- Error Log: CloudWatch ìë™ ì „ì†¡
- Slow Query Log: 2ì´ˆ ì´ìƒ
- General Log: ë¹„í™œì„±í™” (ì„±ëŠ¥)

---

## ğŸ”„ ê³ ê°€ìš©ì„± (HA) êµ¬ì„±

### í˜„ì¬ êµ¬ì„± (Single Instance)
- ë‹¤ìš´íƒ€ì„: 30-60ì´ˆ (ë°°í¬ ì‹œ)
- SPOF: EC2 ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤

### ê¶Œì¥ HA êµ¬ì„±

**1. Multi-AZ RDS**
```hcl
# terraform.tfvars
rds_multi_az = true  # ë¹„ìš© 2ë°°
```

**2. Auto Scaling Group + ALB**
```
ALB
 â”œâ”€ Target Group
 â”‚   â”œâ”€ EC2 Instance (AZ-a)
 â”‚   â””â”€ EC2 Instance (AZ-c)
 â””â”€ Health Check: /actuator/health
```

**3. Blue-Green Deployment**
- Docker Compose ë‚´ë¶€ì—ì„œ Blue/Green ì»¨í…Œì´ë„ˆ
- NGINX ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¡œ íŠ¸ë˜í”½ ì „í™˜

---

## ğŸ› ï¸ Terraform ëª¨ë“ˆ êµ¬ì¡°

```
terraform/
â”œâ”€â”€ main.tf                      # ëª¨ë“ˆ ì¡°í•©
â”œâ”€â”€ backend.tf                   # S3 backend
â”œâ”€â”€ variables.tf                 # ë³€ìˆ˜ ì •ì˜
â”œâ”€â”€ outputs.tf                   # ì¶œë ¥ ê°’
â”‚
â””â”€â”€ modules/
    â”œâ”€â”€ vpc/                     # VPC, Subnets, IGW, Route Tables
    â”œâ”€â”€ security-groups/         # Security Groups
    â”œâ”€â”€ iam/                     # IAM Roles, Policies
    â”œâ”€â”€ ecr/                     # ECR Repository
    â”œâ”€â”€ rds/                     # RDS Instance, Parameter Group
    â””â”€â”€ ec2/                     # EC2 Instance, Elastic IP, CloudWatch Alarms
```

ê° ëª¨ë“ˆì€ ë…ë¦½ì ìœ¼ë¡œ ì¬ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

## ğŸ“Š ìŠ¤ì¼€ì¼ë§ ì „ëµ

### Vertical Scaling (Scale Up)

**EC2:**
```hcl
# terraform.tfvars
ec2_instance_type = "t3.small"  # 2 vCPU, 2GB RAM (+$15/ì›”)
```

**RDS:**
```hcl
rds_instance_class = "db.t3.small"  # 2 vCPU, 2GB RAM (+$15/ì›”)
rds_allocated_storage = 50  # 50GB
```

### Horizontal Scaling (Scale Out)

**Auto Scaling Group:**
- Min: 2 instances
- Max: 4 instances
- Target: CPU 50%

**Read Replica (RDS):**
- ì½ê¸° ë¶€í•˜ ë¶„ì‚°
- ìµœëŒ€ 5ê°œê¹Œì§€

---

## ğŸ”— ì™¸ë¶€ ì—°ë™

### Kakao OAuth
- Redirect URI: `https://catxi-university-taxi-b0936.web.app/callback/kakao`
- Security Group: 443 í¬íŠ¸ ì•„ì›ƒë°”ìš´ë“œ í—ˆìš©

### Firebase FCM
- Service Account JSON: EC2ì— ë§ˆìš´íŠ¸
- Security Group: 443 í¬íŠ¸ ì•„ì›ƒë°”ìš´ë“œ í—ˆìš©

### Discord Webhook
- ë°°í¬ ì•Œë¦¼ ì „ì†¡
- Security Group: 443 í¬íŠ¸ ì•„ì›ƒë°”ìš´ë“œ í—ˆìš©

---

## ì°¸ê³  ìë£Œ

- [AWS VPC Documentation](https://docs.aws.amazon.com/vpc/)
- [AWS RDS Best Practices](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_BestPractices.html)
- [Terraform AWS Provider](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)
- [ë°°í¬ ê°€ì´ë“œ](./DEPLOYMENT.md)
- [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](./TROUBLESHOOTING.md)
